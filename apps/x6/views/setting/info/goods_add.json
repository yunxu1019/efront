{"controller":" [\"$scope\", \"cache\", \"clone\", \"tips\", function ($scope,cache,clone,tips) {\n\t$scope.spxx={\n\t\tid:-1,\n\t\tspmc:\"\",\n\t\tsplx:\"\",\n\t\tpp:\"\",\n\t\tys:\"\",\n\t\tpz:\"\",\n\t\tzs:\"\",\n\t\tisch:0,\n\t\tchcd:15,\n\t\tqyfch:1,\n\t\tfchcd:15,\n\t\tklyjts:\"\",\n\t\tyxbz:0,\n\t\ttags:[]\n\t}\n\t//\u5546\u54c1\u7c7b\u578b\u5217\u8868\n\t$scope.splx=cache.splxList;\n\t//\u914d\u7f6e+\u54c1\u724c+\u989c\u8272+\u5236\u5f0f\u5217\u8868\n\t$scope.pplist=filterProduct(1);\n\t$scope.yslist=filterProduct(2);\n\t$scope.pzlist=filterProduct(3);\n\t$scope.zslist=filterProduct(4);\n\t//console.log($scope.pplist)\n\t//\u83b7\u53d6\u6807\u7b7e\n\tapi(\"/x6/getDmSpxxTagsList.do\",{}).onsuccess(function(data){\n\t\t$scope.labelList=data.tagsList;\n\t\tfor(var i=0;i<$scope.selectList.length;i++){\n\t    \tfor(var j=0;j<$scope.labelList.length;j++){\n\t    \t\tif($scope.selectList[i].id==$scope.labelList[j].id){\n\t    \t\t\t$scope.labelList[j].checked=true;\n\t    \t\t}\n\t    \t}\n\t    }\n\t})\n    $scope.selectList=[];\n    $scope.islist=false;\n    $scope.spxq={\n    \tisqy:0\n    };\n    \n    //\u4fdd\u5b58\u6807\u7b7e\n    $scope.addLabel={\n    \tname:\"\"\n    }\n    $scope.saveLabel=function(txt){\n    \tif(txt.length>5){\n    \t\ttips.warn(\"\u6807\u7b7e\u540d\u79f0\u4e0d\u80fd\u8d85\u8fc74\u4f4d\");\n    \t\treturn false;\n    \t}else{\n//  \t\t$scope.labelList.map(function(i){\n//  \t\t\tif(i.name==txt){\n//  \t\t\t\ttips.warn(\"\u8be5\u6807\u7b7e\u5df2\u5b58\u5728\");\n//  \t\t\t\treturn false;\n//  \t\t\t}\n//  \t\t})\n    \t\tapi(\"/x6/saveDmSpxxTags.do\",{\n    \t\t\tid:-1,\n    \t\t\tname:txt\n    \t\t}).onsuccess(function(data){\n    \t\t\t//\u63d2\u5165\u5230\u6807\u7b7e\u5217\u8868\u4e2d\n    \t\t\t$scope.labelList.unshift(data.spxxTags);\n\t\t\t\t$scope.addLabel.name=\"\";\n    \t\t})\n    \t}\n    }\n    //\u5220\u9664\u6807\u7b7e\n    $scope.delLabel=function(obj,e,index){\n    \te.stopPropagation();\n    \tapi(\"/x6/deleteDmSpxxTags.do\",{\n    \t\tid:obj.id\n    \t}).onsuccess(function(data){\n    \t\t$scope.labelList.splice(index,1);\n    \t})\n    }\n    //\u4fdd\u5b58\u8d27\u54c1\n\tvar save=api.adapt($scope.spxx,{\n        _spmc:\"\",\n        $splx:\"\",\n        $pp:\"\",\n        $ys:\"\",\n        $pz:\"\",\n        $zs:\"\",\n        isch:0,\n        chcd:15,\n        qyfch:1,\n        fchcd:15,\n        klyjts:\"\",\n        yxbz:0,\n        tags:[]\n\t},\"/x6/saveSpxx.do\",\"\u4fdd\u5b58\u8d27\u54c1\u4fe1\u606f\").onsuccess(function(data){\n\t\tconsole.log(data)\n\t\ttips.success(\"\u65b0\u589e\u6210\u529f\");\n\t\t$scope.$CloseView();\n\t}).onpost(function(a){\n        //\u7f51\u7edc\u8bf7\u6c42\u53d1\u8d77\u65f6\uff0c\u7981\u6709\u539f\u6765\u7684\u6309\u94ae\u7ec4\n        $scope.$ViewOptions={\n            \u6b63\u5728\u4fdd\u5b58:function(){\n                return false;\n            }\n        };\n    }).onend(function(){\n        //\u7f51\u7edc\u8bf7\u6c42\u7ed3\u675f\u540e\uff0c\u8fd8\u539f\u6309\u94ae\u7ec4\n        $scope.$ViewOptions=viewOptions;\n    });\n    $scope.$ViewOptions={\n    \t\"\u786e\u8ba4\":function(){\n    \t\t// if($scope.selectList.length){\n    \t\t// \tvar labelArray=[];\n    \t\t// \t$scope.selectList.map(function(i){\n    \t\t// \t\tlabelArray.push({\n    \t\t// \t\t\tname:i.name\n    \t\t// \t\t})\n    \t\t// \t})\n    \t\t// \t$scope.spxx.tags=labelArray;\n    \t\t// }\n    \t\t//\n    \t\t// $scope.spxx.splx=$scope.spxx.splx.bm;\n\t\t\tsave()\n\t\t\treturn false;\n    \t},\n    \t\"\u53d6\u6d88\":function(){\n    \t\t\n    \t}\n    }\n    \n    $scope.selectLabel=function(obj,index){\n    \t$scope.labelList[index].checked=!$scope.labelList[index].checked;\n    \tif($scope.labelList[index].checked){\n    \t\t$scope.selectList.push(obj)\n    \t}else{\n    \t\tfor(var i=0;i<$scope.selectList.length;i++){\n    \t\t\tif($scope.selectList[i].id==obj.id){\n    \t\t\t\t$scope.selectList.splice(i,1);\n    \t\t\t}\n    \t\t}\n    \t}\n    }\n    $scope.removeLabel=function(obj,index){\n    \t$scope.selectList.splice(index,1);\n    \tfor(var j=0;j<$scope.labelList.length;j++){\n\t    \tif(obj.id==$scope.labelList[j].id){\n\t    \t\t//console.log($scope.selectList[index].id)\n\t    \t\t$scope.labelList[j].checked=false;\n\t    \t}\n\t    }\n    }\n\t$scope.setDays=function(){\n\t\tif(!$scope.spxx.klyjts){\n\t\t\t$scope.spxx.klyjts=10;\n\t\t}\n\t}\n\t\n//\tfunction getLists(url,params){\n//\t\tvar params=params?params:{};\n//\t\tvar promise=new Promise(function(resolve,reject){\n//\t\t\tapi(url,params).onsuccess(function(data){\n//\t\t\t\tresolve(data);\t\t\n//\t\t\t})\n//\t\t})\n//\t}\n\t\n\tfunction filterProduct(type){\n\t\tvar array=[];\n\t\tfor(var i=0;i<cache.sppzList.length;i++){\n\t\t\tif(cache.sppzList[i].pztype==type){\n\t\t\t\t//cache.sppzList[i].index=i;\n\t\t\t\tarray.push(cache.sppzList[i].name);\n\t\t\t\t//delete cache.sppzList[i].index;\n\t\t\t}\n\t\t}\n\t\treturn array;\n\t}\n\t\n\tfunction bmToName(bm){\n\t\tfor(var i=0;i<cache.splxList.length;i++){\n\t\t\tif(cache.splxList[i].bm==bm){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn cache.splxList[i].name;\n\t}\n\t\n\tfunction nameToBm(name){\n\t\tfor(var i=0;i<cache.splxList.length;i++){\n\t\t\tif(cache.splxList[i].name==name){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn cache.splxList[i].bm;\n\t}\n\t\n\tfunction tagsToString(tags){\n\t\tvar tag=\"\";\n\t\tfor(var i=0;i<JSON.parse(tags).length;i++){\n\t\t\ttag+=\",\"+JSON.parse(tags)[i].name;\n\t\t}\n\t\treturn tag.substring(1);\n\t}\n}]","template":"<style>.setting-info-goods_add > div.title {\n  height: 42px;\n}\n.setting-info-goods_add > .noscroll-content {\n  padding: 10px;\n}\n.setting-info-goods_add > .noscroll-content .field {\n  margin: 10px;\n}\n.setting-info-goods_add > .noscroll-content .anniu {\n  margin: 10px;\n}\n.setting-info-goods_add .edit-item {\n  width: 360px;\n  height: 27px;\n  display: inline-block;\n  margin: 10px 0;\n  float: left;\n}\n.setting-info-goods_add .edit-item > span {\n  display: block;\n  float: left;\n  text-align: right;\n  line-height: 27px;\n  width: 103px;\n}\n.setting-info-goods_add .edit-item .switch {\n  margin-top: 0;\n}\n.setting-info-goods_add .required:before {\n  content: '*';\n  color: red;\n  line-height: 22px;\n}\n.setting-info-goods_add .edit-item:last-child > span {\n  width: 98.5px;\n}\n.setting-info-goods_add .select-label {\n  display: inline-block;\n  width: 210px;\n  height: auto;\n  position: relative;\n  float: left;\n}\n.setting-info-goods_add .select-label > div:first-child {\n  width: 98%;\n  height: auto;\n  padding: 0 1%;\n}\n.setting-info-goods_add .select-label > div:first-child > .label {\n  display: inline-block;\n  min-width: 50px;\n  height: 21px;\n  line-height: 17px;\n  padding: 2px 5px;\n  margin: 2px 5px;\n  padding-right: 13px;\n  background: #dcdcdc;\n  font-size: 12px;\n  position: relative;\n  border-radius: 17px ;\n  cursor: pointer;\n  -webkit-transition: all .3s;\n  transition: all .3s;\n  overflow: hidden;\n}\n.setting-info-goods_add .select-label > div:first-child > .label:before {\n  content: '';\n  display: inline-block;\n  width: 5px;\n  height: 5px;\n  border-radius: 50% ;\n  vertical-align: middle;\n  background: #4385F4;\n  margin: 0 5px;\n}\n.setting-info-goods_add .select-label > div:first-child > .label > i {\n  font-size: 12px;\n  margin-left: 7px;\n  right: -17px;\n  color: #888;\n  -webkit-transition: all .3s;\n  transition: all .3s;\n  position: absolute;\n}\n.setting-info-goods_add .select-label > div:first-child > .label > i:hover {\n  color: #4385F3;\n}\n.setting-info-goods_add .select-label > div:first-child > .label:hover {\n  padding-right: 25px ;\n}\n.setting-info-goods_add .select-label > div:first-child > .label:hover i {\n  right: 5px;\n}\n.setting-info-goods_add .select-label > div:first-child > .add-btn {\n  display: inline-block;\n  font-size: 21px;\n  margin-left: 5px;\n  color: #4385F4;\n  cursor: pointer;\n  vertical-align: top;\n}\n.setting-info-goods_add .select-label > div:first-child + div {\n  width: 100%;\n  height: auto;\n  margin-top: 7px;\n  border: 1px solid #ccc ;\n  position: absolute;\n  -webkit-user-select: none;\n}\n.setting-info-goods_add .select-label > div:first-child + div > .add-name {\n  width: 100%;\n  height: 25px;\n  padding: 0 5%;\n  border-bottom: 1px solid #ccc ;\n}\n.setting-info-goods_add .select-label > div:first-child + div > .add-name > .text-input {\n  width: 80%;\n  height: 90%;\n  margin-top: 2px;\n  border: none;\n  outline: none;\n  color: #666;\n}\n.setting-info-goods_add .select-label > div:first-child + div > .add-name > span {\n  float: right;\n  margin-top: 2px;\n  font-size: 14px;\n  color: #4385F4;\n  cursor: pointer;\n}\n.setting-info-goods_add .select-label > div:first-child + div > .add-items {\n  width: 100%;\n  line-height: 25px;\n  padding: 0 5%;\n  font-size: 12px;\n  cursor: pointer;\n}\n.setting-info-goods_add .select-label > div:first-child + div > .add-items:hover {\n  background: #F1F2F3;\n}\n.setting-info-goods_add .select-label > div:first-child + div > .add-items:before {\n  content: '';\n  display: inline-block;\n  width: 5px;\n  height: 5px;\n  margin-right: 15px;\n  vertical-align: middle;\n  border-radius: 50% ;\n  background: #4385F3;\n}\n.setting-info-goods_add .select-label > div:first-child + div > .add-items > i {\n  float: right;\n  color: #7eaaf5;\n}\n.setting-info-goods_add .select-label > div:first-child + div > .add-items > .close {\n  font-size: 12px;\n  color: #ccc;\n}\n.setting-info-goods_add .select-label > div:first-child + div > .add-items > .close:hover {\n  color: #4385f5;\n}\n</style><!--<field name=\"\u5206\u7c7b\"><selector empty-label=\"\u8bf7\u9009\u62e9\u5206\u7c7b\"></selector></field>\r\n<field name=\"\u54c1\u724c\"><selector input empty-label=\"\u8bf7\u9009\u62e9\u54c1\u724c\"></selector></field>\r\n<field name=\"\u540d\u79f0\"><text-input placeholder=\"\u8bf7\u8f93\u5165\u540d\u79f0\"></text-input></field>\r\n<field name=\"\u914d\u7f6e\"><selector input empty-label=\"\u8bf7\u9009\u62e9\u914d\u7f6e\"></selector></field>\r\n<field name=\"\u989c\u8272\"><selector input empty-label=\"\u8bf7\u9009\u62e9\u989c\u8272\"></selector></field>\r\n<field name=\"\u5236\u5f0f\"><selector empty-label=\"\u8bf7\u9009\u62e9\u5236\u5f0f\"></selector></field>\r\n<field name=\"\u542f\u7528\u4e32\u53f7\"><selector></selector></field>\r\n<field name=\"\u4e32\u53f7\u957f\u5ea6\"><selector empty-label=\"\u8bf7\u9009\u62e9\u662f\u5426\u542f\u7528\u4e32\u53f7\"></selector></field>\r\n<field name=\"\u8f85\u52a9\u4e32\u53f7\u7ba1\u7406\"><selector empty-label=\"\u8bf7\u9009\u62e9\u662f\u5426\u542f\u7528\u4e32\u53f7\"></selector></field>\r\n<field name=\"\u8f85\u52a9\u4e32\u53f7\u957f\u5ea6\"><selector empty-label=\"\u8bf7\u9009\u62e9\u662f\u5426\u542f\u7528\u4e32\u53f7\"></selector></field>\r\n<field name=\"\u5e93\u9f84\u9884\u8b66\u5929\u6570\"><selector empty-label=\"\u8bf7\u9009\u62e9\u662f\u5426\u542f\u7528\u4e32\u53f7\"></selector></field>\r\n<field name=\"\u542f\u52a8\u6807\u5fd7\"><selector empty-label=\"\u8bf7\u9009\u62e9\u662f\u5426\u542f\u7528\u4e32\u53f7\"></selector></field>-->\r\n<div class=\"edit-item\">\r\n\t<span  class=\"required\">\u5206\u7c7b \uff1a </span>\r\n\t<selector source=\"splx\" field=\"name\" ng-model=\"spxx.splx\"></selector>\r\n</div>\r\n<div class=\"edit-item\">\r\n\t<span class=\"required\">\u54c1\u724c \uff1a </span>\r\n\t<selector input ng-model=\"spxx.pp\" source=\"pplist\" ng-change=\"setDays()\"></selector>\r\n</div>\r\n<div class=\"edit-item\">\r\n\t<span class=\"required\">\u540d\u79f0 \uff1a </span>\r\n\t<text-input placeholder=\"\u8bf7\u8f93\u5165\u540d\u79f0\" ng-model=\"spxx.spmc\"></text-input>\r\n</div>\r\n<div class=\"edit-item\">\r\n\t<span class=\"required\">\u914d\u7f6e \uff1a </span>\r\n\t<selector input ng-model=\"spxx.pz\" source=\"pzlist\"></selector>\r\n</div>\r\n<div class=\"edit-item\">\r\n\t<span class=\"required\">\u989c\u8272 \uff1a </span>\r\n\t<selector input ng-model=\"spxx.ys\" source=\"yslist\"></selector>\r\n</div>\r\n<div class=\"edit-item\">\r\n\t<span class=\"required\">\u5236\u5f0f \uff1a </span>\r\n\t<selector  ng-model=\"spxx.zs\" source=\"zslist\"></selector>\r\n</div>\r\n<div class=\"edit-item\">\r\n\t<span>\u542f\u7528\u4e32\u53f7 \uff1a </span>\r\n\t<on-off yxbz=\"spxx.isch\"></on-off>\r\n</div>\r\n<div class=\"edit-item\" ng-hide=\"spxx.isch\">\r\n\t<span>\u4e32\u53f7\u957f\u5ea6 \uff1a </span>\r\n\t<text-input  ng-model=\"spxx.chcd\"></text-input>\r\n</div>\r\n<div class=\"edit-item\">\r\n\t<span>\u8f85\u4e32\u53f7\u7ba1\u7406 \uff1a </span>\r\n\t<on-off yxbz=\"spxx.qyfch\"></on-off>\r\n</div>\r\n<div class=\"edit-item\" ng-hide=\"spxx.qyfch\">\r\n\t<span>\u8f85\u4e32\u53f7\u957f\u5ea6 \uff1a </span>\r\n\t<text-input  ng-model=\"spxx.fchcd\"></text-input>\r\n</div>\r\n<div class=\"edit-item\">\r\n\t<span>\u5e93\u9f84\u9884\u8b66\u5929\u6570 \uff1a </span>\r\n\t<text-input ng-model=\"spxx.klyjts\"></text-input>\r\n</div>\r\n<div class=\"edit-item\">\r\n\t<span>\u542f\u7528\u6807\u5fd7 \uff1a </span>\r\n\t<on-off yxbz=\"spxx.yxbz\"></on-off>\r\n</div>\r\n<div class=\"edit-item\">\r\n\t<span>\u6807\u7b7e : </span>\r\n\t<div class=\"select-label\">\r\n\t\t<div>\r\n\t\t\t<div class=\"label\" ng-repeat=\"item in selectList\">{{item.name}}<i class=\"iconfont icon-shanchu1\" ng-click=\"removeLabel(item,$index)\"></i></div>\r\n\t\t\t<i class=\"iconfont add-btn\" ng-class=\"{false:'icon-add3',true:'icon-jianhao'}[islist]\" ng-click=\"islist=!islist;\"></i>\r\n\t\t</div>\r\n\t\t<div ng-if=\"islist\">\r\n\t\t\t<div class=\"add-name\">\r\n\t\t\t\t<text-input ng-model=\"addLabel.name\" placeholder=\"\u8bf7\u8f93\u5165\u540d\u79f0\"></text-input>\r\n\t\t\t\t<span ng-click=\"saveLabel(addLabel.name)\">\u6dfb\u52a0</span>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"add-items\"  ng-repeat=\"item in labelList\"  ng-click=\"selectLabel(item,$index)\">{{item.name}}<i class=\"iconfont icon-icon2\" ng-if=\"item.checked\"></i><i class=\"iconfont icon-cha close\" ng-hide=\"item.checked\" ng-click=\"delLabel(item,$event,$index)\"></i></div>\r\n\t\t</div>\r\n\t</div>\r\n</div>"}