{"controller":"[\"$scope\", \"cache\", \"$filter\", \"clone\", \"tips\", \"vertify\", function($scope,cache,$filter,clone,tips,vertify){\n    $scope.bar=[\"\u8d26\u6237\u4fe1\u606f\",\"\u5173\u8054\u6253\u6b3e\u95e8\u5e97\"];\n    $scope.isprev=false;\n    $scope.isnext=!$scope.isprev;\n    $scope.active=0;\n    $scope.slideLeft=false;\n    //\u5bc4\u5b58\u9009\u4e2d\u95e8\u5e97\u7684id\n    var selectedShop=[];\n    $scope.zhlx=[\n    \t\t{id:0,name:\"\u5bf9\u516c\"},\n    \t\t{id:1,name:\"\u5bf9\u79c1\"}\n    \t]\n    $scope.zh={\n    \tid:-1,\n    \tzhname:\"\",\n    \tkhh:\"\",\n    \tzh:\"\",\n    \tzhlx:\"\",\n    \tyxbz:0\n    }\n    //\u5206\u516c\u53f8\u5217\u8868&&\u95e8\u5e97\u5217\u8868\n    $scope.company=getFgsAndShop(cache.gslist).company;\n    $scope.shop=getFgsAndShop(cache.gslist).shop;\n    $scope.switchMain=function(num){\n    \t$scope.slideLeft=$scope.isprev=$scope.active=num;\n    \t$scope.isnext=num?0:1;\n    }\n    //\u70b9\u51fb\u9009\u4e2d\u95e8\u5e97\n    $scope.selectShop=function(bm,obj){\n    \tvar sum=0;\n    \tvar mdArray=$filter(\"shopfilter\")($scope.shop,bm);\n    \tmdArray.map(function(i){\n    \t\tif(i.issel){\n    \t\t\tsum++;\n    \t\t\tif(sum==mdArray.length){\n    \t\t\t\tobj.isall=true;\n    \t\t\t}\n\t\t\t\tif(selectedShop.indexOf(i.id)==-1){\n\t\t\t\t\tselectedShop.push(i.id);\n\t\t\t\t}\n    \t\t}else{\n    \t\t\tobj.isall=false;\n    \t\t\tif(selectedShop.indexOf(i.id)!=-1){\n\t\t\t\t\tselectedShop.splice(selectedShop.indexOf(i.id),1);\n\t\t\t\t}\n    \t\t}\n    \t})\n    \tobj.sl=sum;\n\t\tconsole.log(selectedShop)\n    \t//console.log(obj)\n    }\n    //\u5168\u9009\n    $scope.allSelect=function(bm,obj,isall){\n    \tvar mdArray=$filter(\"shopfilter\")($scope.shop,bm);\n    \tmdArray.map(function(i){\n    \t\tif(isall){\n    \t\t\ti.issel=true;\n    \t\t\tif(selectedShop.indexOf(i.id)==-1){\n\t\t\t\t\tselectedShop.push(i.id);\n\t\t\t\t\tobj.sl++;\n\t\t\t\t}\n\t    \t}else{\n\t    \t\ti.issel=false;\n\t    \t\tif(selectedShop.indexOf(i.id)!=-1){\n\t\t\t\t\tselectedShop.splice(selectedShop.indexOf(i.id),1);\n\t\t\t\t\tobj.sl--;\n\t    \t\t}\n\t    \t}\n    \t})\n    \tconsole.log(selectedShop)\n    }\n    //\u4fdd\u5b58\u4fe1\u606f\n    $scope.save=function(){\n    \tvar requires=[\n\t\t\t{\n\t\t\t\tname:\"zhname\",\n\t\t\t\tmsg:\"\u8bf7\u8f93\u5165\u8d26\u53f7\"\n\t\t\t}\n\t\t]\n    \tconsole.log($scope.data)\n    \tvar tempobj=clone.object($scope.zh);\n    \ttempobj.zhlx=tempobj.zhlx.id;\n    \ttempobj.yxmd=selectedShop.join(\",\");\n    \tconsole.log(tempobj)\n    \tapi(\"/x6/saveYhzh.do\",tempobj).onsuccess(function(data){\n    \t\ttips.success(\"\u65b0\u589e\u6210\u529f\");\n            $scope.data.push(data.yhzh);\n            $scope.$CloseView()\n    \t})\n    }\n    //\u53d6\u51fa\u5206\u516c\u53f8\u53ca\u95e8\u5e97\n    function getFgsAndShop(obj){\n    \tvar company=[];\n    \tvar shop=[];\n    \tfor(var i=0,len=obj.length;i<len;i++){\n    \t\tif(obj[i].lx==2){\n    \t\t\tobj[i].sl=0;\n    \t\t\tcompany.push(obj[i])\n    \t\t}\n    \t\tif(obj[i].lx==3){\n    \t\t\tshop.push(obj[i])\n    \t\t}\n    \t}\n    \treturn {\n    \t\tcompany:company,\n    \t\tshop:shop\n    \t}\n    }\n}]","template":"<style>.setting-info-zhanghu_add p {\n  width: 55%;\n  margin: 25px auto;\n  border: 1px solid #4385F3;\n  border-radius: 3px ;\n  font-size: 0;\n}\n.setting-info-zhanghu_add p > span {\n  width: 50%;\n  line-height: 25px;\n  text-align: center;\n  display: inline-block;\n  font-size: 14px;\n  color: #4385F3;\n  cursor: pointer;\n}\n.setting-info-zhanghu_add p > span.selected {\n  background: #4385F3;\n  color: #fff;\n}\n.setting-info-zhanghu_add .add-main {\n  width: 200%;\n  height: -webkit-calc(100% - 133px);\n  height: calc(100% - 133px);\n  overflow: hidden;\n  -webkit-transition: all .2s;\n  transition: all .2s;\n}\n.setting-info-zhanghu_add .add-main > div {\n  width: 50%;\n  height: 100%;\n  font-size: 14px;\n  float: left;\n}\n.setting-info-zhanghu_add .add-main > div:first-child > div {\n  width: 325px;\n  margin: 10px auto;\n}\n.setting-info-zhanghu_add .add-main > div:first-child > div > span {\n  display: block;\n  width: 70px;\n  line-height: 30px;\n  float: left;\n}\n.setting-info-zhanghu_add .add-main > div:first-child > div > .text-input,\n.setting-info-zhanghu_add .add-main > div:first-child > div > .selector {\n  height: 30px;\n}\n.setting-info-zhanghu_add .add-main > div:first-child > div > .on-off {\n  margin-left: 0;\n}\n.setting-info-zhanghu_add .add-main > div:nth-child(2) > div {\n  width: 90%;\n  height: 100%;\n  margin: 0 5%;\n}\n.setting-info-zhanghu_add .add-main > div:nth-child(2) > div > .items {\n  width: 100%;\n  margin-top: 15px;\n  overflow: hidden;\n}\n.setting-info-zhanghu_add .add-main > div:nth-child(2) > div > .items > .item-title > div {\n  display: inline-block;\n}\n.setting-info-zhanghu_add .add-main > div:nth-child(2) > div > .items > .item-title > div > .checkbox {\n  margin-right: 5px;\n}\n.setting-info-zhanghu_add .add-main > div:nth-child(2) > div > .items > .item-shop {\n  width: 22%;\n  line-height: 20px;\n  padding: 0 2px;\n  margin-left: 2%;\n  margin-top: 10px;\n  border: 1px dashed #ccc;\n  float: left;\n  cursor: pointer;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  text-align: center;\n}\n.setting-info-zhanghu_add .add-main > div:nth-child(2) > div > .items > .selected {\n  border: 1px solid #4385F3;\n  color: #4385F3;\n}\n.setting-info-zhanghu_add .add-main > div:nth-child(2) > div > .items > .item-shop:nth-child(4n-2) {\n  margin-left: 0;\n}\n.setting-info-zhanghu_add .switch-control {\n  -webkit-transform: translateX(-50%);\n      -ms-transform: translateX(-50%);\n          transform: translateX(-50%);\n}\n.setting-info-zhanghu_add .add-control {\n  padding: 15px 15px 15px 0;\n  border-top: 1px solid #ddd ;\n  background: #f2f2f2;\n  text-align: right;\n}\n.setting-info-zhanghu_add .add-control > .anniu {\n  cursor: pointer;\n  margin-left: 10px;\n}\n</style><p>\r\n\t<span ng-repeat=\"item in bar\" ng-bind=\"item\" ng-class=\"{'selected':active==$index}\"></span>\r\n</p>\r\n<div class=\"add-main\" ng-class=\"{'switch-control':slideLeft}\">\r\n\t<div>\r\n\t\t<div>\r\n\t\t\t<span>\u94f6\u884c\u540d\u79f0</span>\r\n\t\t\t<text-input ng-model=\"zh.zhname\"></text-input>\r\n\t\t</div>\r\n\t\t<div>\r\n\t\t\t<span>\u5f00\u6237\u884c</span>\r\n\t\t\t<text-input ng-model=\"zh.khh\"></text-input>\r\n\t\t</div>\r\n\t\t<div>\r\n\t\t\t<span>\u8d26\u53f7</span>\r\n\t\t\t<text-input ng-model=\"zh.zh\"></text-input>\r\n\t\t</div>\r\n\t\t<div>\r\n\t\t\t<span>\u8d26\u6237\u7c7b\u578b</span>\r\n\t\t\t<selector source=\"zhlx\" field=\"name\" ng-model=\"zh.zhlx\"></selector>\r\n\t\t</div>\r\n\t\t<div>\r\n\t\t\t<span>\u94f6\u884c\u540d\u79f0</span>\r\n\t\t\t<on-off yxbz=\"zh.yxbz\"></on-off>\r\n\t\t</div>\r\n\t\t\r\n\t</div>\r\n\t<div>\r\n\t\t<div>\r\n\t\t\t<div class=\"items\" ng-repeat=\"fgs in company\" ng-if=\"(shop|shopfilter:fgs.bm).length\">\r\n\t\t\t\t<div class=\"item-title\"><div ng-click=\"allSelect(fgs.bm,fgs,fgs.isall)\"><checkbox ng-model=\"fgs.isall\"></checkbox></div>{{fgs.name}}&emsp;{{fgs.sl}}/{{(shop|shopfilter:fgs.bm).length}}</div>\r\n\t\t\t\t<div class=\"item-shop\" ng-repeat=\"md in shop|shopfilter:fgs.bm\" ng-bind=\"md.name\" ng-click=\"md.issel=!md.issel;selectShop(fgs.bm,fgs)\" ng-class=\"{'selected':md.issel}\"></div>\t\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n<div class=\"add-control\">\r\n\t<!--<anniu ng-click='switchMain(1)' ng-if=\"isnext\">\u786e\u8ba4</anniu>-->\r\n\t<anniu candidate ng-click='switchMain(0)' ng-if=\"isprev\">\u4e0a\u4e00\u6b65</anniu>\r\n\t<anniu candidate ng-click='switchMain(1)' ng-if=\"isnext\">\u4e0b\u4e00\u6b65</anniu>\r\n\t<anniu ng-click='save()' ng-if=\"isprev\">\u4fdd\u5b58</anniu>\r\n</div>"}