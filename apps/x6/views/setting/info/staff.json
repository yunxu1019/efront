{"controller":" [\"$scope\", \"views\", \"popup\", \"tasks\", \"api\", \"cache\", \"alert\", \"getScreenPosition\", \"$compile\", function ($scope, views, popup, tasks, api, cache, alert,getScreenPosition,$compile) {\n    $scope.staff = {};\n\n    $scope.$on(\"$destroy\", function () {\n        console.log(tasks(), 'tasks');\n    });\n    $scope.ondrop = function () {\n    };\n    $scope.filter = function () {\n        $scope.filter.ing = !$scope.filter.ing;\n    };\n    //\u65b0\u589e\u4e0e\u5458\u5de5\u4fe1\u606f\n    $scope.add = function () {\n        popup(\"/setting/info/staff_add\", {\n            \"$ViewTitle\": \"\u65b0\u589e\u5458\u5de5\u4fe1\u606f\",\n            \"$ViewOptions\": {\n                \"\u4fdd\u5b58\": function () {\n\n                },\n                \"\u5173\u95ed\": function () {\n\n                }\n            }\n        }, {width: 648, height: 684})\n    };\n\n    $scope.data = {\n        \u4e2d\u79d1\u9662\u7eb3\u7c73\u6240: {\n            \u4e00\u533a: [\n                \"\u6c5f\u82cf\",\n                \"\u6d59\u6c5f\"\n            ],\n            \u65e0\u9521\u4e2d\u5fc3: []\n        }\n    };\n    \n    //\u663e\u793a\u72b6\u6001\n    $scope.xschoose=false;\n    $scope.displayChoose=function(){\n    \t$scope.xschoose=true;\n    };\n    $scope.hideChoose=function(){\n    \t$scope.xschoose=false;\n    }\n    $scope.staffs = [\n\n    ];\n    var gsList = [];//\u516c\u53f8\n    var gwList = []; //\u5c97\u4f4d  \n    api('/x6/getXtGsList.do', {}).onsuccess(function (data) {\n        gsList = data.gsList;\n    })\n    api('/x6/loadGwxxList.do', {}).onsuccess(function (data) {\n        gwList = data.gwxxList;\n        \n    })\n    $scope.user.yxbz0 = false;\n    $scope.user.yxbz1 = false;\n    $scope.user.yxbz2 = true;\n    $scope.qi0 = function (yxbz) {\n        $scope.user.yxbz1 = false;\n        $scope.user.yxbz2 = false;\n        $scope.getUserList(yxbz);\n    }\n    $scope.qi1 = function (yxbz) {\n        $scope.user.yxbz0 = false;\n        $scope.user.yxbz2 = false;\n        $scope.getUserList(yxbz);\n    }\n    $scope.qi2 = function (yxbz) {\n        $scope.user.yxbz0 = false;\n        $scope.user.yxbz1 = false;\n        $scope.getUserList(yxbz);\n    }\n    //\u5458\u5de5\u5217\u8868\n    //console.log(cache);\n    $scope.getUserList = function (yxbz) {\n        $scope.staffs = [];\n        var params = {\n            yxbz: yxbz\n        };\n        api('/x6/loadUserList.do', params).onsuccess(function (data) {\n            var list = data.userList;\n            api('/x6/loadGwxxList.do', {}).onsuccess(function (data) {\n                gwList = data.gwxxList;\n            })\n            for (var i = 0; i < list.length; i++) {\n                list[i].gereninf = list[i].name + \" \" + list[i].phone;\n                list[i].zaizhi = list[i].yxbz == 0 ? '\u5728\u804c' : '\u79bb\u804c';\n                list[i].quanxian = list[i].allowlogin == 0 ? '\u4e0d\u5141\u8bb8' : '\u5141\u8bb8';\n                for (var j = 0; j < gsList.length; j++) {\n                    if (list[i].ssgsid == gsList[j].id) {\n                        list[i].ssgsname = gsList[j].name;\n                        break;\n                    }\n                }\n                \n                $scope.staffs.push(list[i]);\n            }\n            \n        });\n\n    }\n    $scope.getUserList(2);\n    //\u4e2a\u4eba\u6743\u9650\u8bbe\u7f6e\n    //$\u8868\u5f0f\u4e00\u884c\u6570\u636e\n    $scope.limit_template = function () {\n        return \"<span style='cursor:pointer;' ng-mouseenter='removelimit();editlimit($event)'><img src='images/limit.png'/></span>\"\n    }();\n      var element = null;\r\n    $scope.removelimit = function () {\r\n        element && function () {\r\n            var e = element[0];\r\n            setTimeout(function () {\r\n                e.parentNode&&e.parentNode.removeChild(e);\r\n            }, 100);\r\n        }();\r\n    };\r\n    $scope.editlimit = function ($event) {   \t\r\n        var div = [\r\n            \"<div class=limit-box>\",\r\n            '<div><checkbox ng-model=staff.cbjm>\u6210\u672c\u52a0\u5bc6</checkbox></div>',\r\n            '<div><checkbox ng-model=staff.dy>\u6253\u5370</checkbox></div>',\r\n            '<div><checkbox ng-model=staff.dc>\u5bfc\u51fa</checkbox></div>',\r\n            \"<div>\u67e5\u8be2\u5929\u6570</div>\",\r\n            \"<div><number-input ng-model=staff.cxts></number-input>\u5929<anniu ng-click=confirmlimit($)>\u786e\u5b9a</anniu></div>\",\r\n            \"</div>\"\r\n        ].join(\"\");\r\n        element = angular.element(div);\r\n        var target=$event.target;\r\n        var position=getScreenPosition(target);\r\n        element.css({\r\n            \"left\":position.left+target.offsetWidth+'px',\r\n            \"top\":position.top+(target.offsetHeight>>1)+\"px\",\r\n            \"width\":\"170px\",\r\n            \"height\":\"148px\",\r\n            marginTop:'-74px',\r\n            position:\"fixed\",\r\n            backgroundColor:\"#fff\",\r\n            zIndex:999999999\r\n        });\r\n        var e=element[0];\n        var scp=$scope.$new();\n        scp.$=angular.element($event.target).scope().$;\n        $compile(element)(scp)\r\n        setTimeout(function(){\r\n            if(element[0]===e){            \t\r\n                var this_view=document.getElementsByClassName(\"setting-info-staff\")[0]\r\n                this_view.appendChild(e);\r\n            };\r\n        },50);       \r\n    };\r\n    $scope.$on(\"$destroy\",function(){\r\n        element.remove();\r\n    });\n\t$scope.confirmlimit=function($){\n\t\t\n\t\t\n\t\tif (!$scope.staff.cxts) {\n            $scope.staff.cxts = 0;\n        }\n        $scope.staff.iscbjm = $scope.staff.cbjm == true ? 1 : 0;\n        $scope.staff.isdc = $scope.staff.dc == true ? 1 : 0;\n        $scope.staff.isdy = $scope.staff.dy == true ? 1 : 0;\n        var flags = {\n            \"dc\": $scope.staff.isdc,\n            \"dy\": $scope.staff.isdy,\n            \"cxts\": $scope.staff.cxts\n        }\n       \n        var params = {\n            ids: $.id,\n            iscbjm: $scope.staff.iscbjm,\n            flags: flags\n        }\n        console.log(params)\n        api('/x6/updateQxBatch.do', params).onsuccess(function (data) {\n            if (data.result == \"ok\") {\n                alert.success(\"\u8bbe\u7f6e\u6210\u529f\");\n            } else {\n                alert.warn(data.message);\n                return false;\n            }\n        });\n\t}\n    //\u7f16\u8f91\u4e2a\u4eba\u4fe1\u606f\n    $scope.edit = function ($, $data) {   \t\n        localStorage.userid = $.id;\n        localStorage.gsdm = $.gsdm;\n        $scope.xstc = true;\n    }\n    $scope.close = function () {\n        $scope.xstc = false;\n    }\n    //\u6279\u91cf\u8bbe\u7f6e\n    $scope.shtop = 0;\n    $scope.checked = [];\n    var setArray = [];\n    $scope.fn = function () {\n\n        $scope.shtop = 1;\n        $scope.chooseNum = $scope.checked.length;\n        if ($scope.checked.length == $scope.staffs.length) {\n            setArray = $scope.checked;\n        } else {\n            var indexs = [];\n            setArray = [];\n            for (var i = 0; i < $scope.checked.length; i++) {\n                indexs.push($scope.checked[i])\n            }\n            for (var i = 0; i < indexs.length; i++) {\n                setArray.push($scope.staffs[indexs[i]]);\n            }\n        }\n        if ($scope.checked.length == 0) {\n            $scope.shtop = 0;\n        }\n    }\n\t\n    $scope.showCancel = function () {\n        $scope.shtop = 0;\n    }\n    $scope.open = function () {\n        $scope.shtop = 1;\n    }\n    //\u663e\u793a\u5b89\u5168\u8bbe\u7f6e\n    $scope.displayOption = function () {\n        if (!$scope.xsoption) {\n            $scope.xsoption = false;\n        }\n        $scope.xsoption = $scope.xsoption == false ? true : false;\n    }\n\n    //\u4fdd\u5b58\u5b89\u5168\u8bbe\u7f6e \u6279\u91cf\u4fee\u6539\u6743\u9650   \n    $scope.staff.cbjm = 0;\n    $scope.staff.dy = 0;\n    $scope.staff.dc = 0;\n    $scope.confirm = function () {\n        //alert($scope.staff.cxts);\n        //console.log(setArray);\n        if (!$scope.staff.cxts) {\n            $scope.staff.cxts = 0;\n        }\n        $scope.staff.iscbjm = $scope.staff.cbjm == true ? 1 : 0;\n        $scope.staff.isdc = $scope.staff.dc == true ? 1 : 0;\n        $scope.staff.isdy = $scope.staff.dy == true ? 1 : 0;\n        var flags = {\n            \"dc\": $scope.staff.isdc,\n            \"dy\": $scope.staff.isdy,\n            \"cxts\": $scope.staff.cxts\n        }\n        var idsArray = [];\n        for (var i = 0; i < setArray.length; i++) {\n            idsArray.push(setArray[i].id);\n        }\n        var params = {\n            ids: idsArray.join(),\n            iscbjm: $scope.staff.iscbjm,\n            flags: flags\n        }\n        api('/x6/updateQxBatch.do', params).onsuccess(function (data) {\n            if (data.result == \"ok\") {\n                alert.success(\"\u8bbe\u7f6e\u6210\u529f\");\n            } else {\n                alert.warn(data.message);\n                return false;\n            }\n        });\n    }\n    //\u6279\u91cf\u5220\u9664    \n    $scope.bachDelete = function () {\n        var idsArray = [];\n        for (var i = 0; i < setArray.length; i++) {\n            idsArray.push(setArray[i].id);\n        }\n        var params = {\n            ids: idsArray.join()\n        }\n        api('/x6/deleteUserBatch.do', params).onsuccess(function (data) {\n            if (data.result == \"ok\") {\n                alert.success(\"\u5220\u9664\u6210\u529f\");\n                $scope.getUserList(2);\n            } else {\n                alert.warn(data.message);\n                return false;\n            }\n        });\n    }\n    //\u5f00\u901a\u65b0\u5458\u5de5\n    $scope.openNewyg = function () {\n        var idsArray = [];\n        for (var i = 0; i < setArray.length; i++) {\n            idsArray.push(setArray[i].id);\n        }\n        var params = {\n            ids: idsArray.join()\n        }\n        api('/x6/checkUserBatch.do', params).onsuccess(function (data) {\n            if (data.result == \"ok\") {\n                alert.success(\"\u5f00\u901a\u6210\u529f\");\n//\t\t\t\t$scope.user.yxbz2=true;\n//\t\t\t\t$scope.user.yxbz0=false;\n//\t\t\t\t$scope.user.yxbz1=false;\n                $scope.getUserList(2);\n//\t\t\t\t$scope.shtop=0;\n            } else {\n                alert.warn(data.message);\n                return false;\n            }\n        });\n    }\n}]","template":"<style>.setting-info-staff .limit-box {\n  border: 1px solid #4385f5;\n  background-color: #fff;\n  overflow: visible;\n  border: 1px solid rgba(0, 0, 0, 0.2);\n  box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);\n  text-align: left;\n  line-height: 20px;\n}\n.setting-info-staff .limit-box:before {\n  width: 14px;\n  height: 14px;\n  border: 1px solid rgba(0, 0, 0, 0.2);\n  box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);\n  display: block;\n  content: '';\n  -webkit-transform: rotate(45deg);\n      -ms-transform: rotate(45deg);\n          transform: rotate(45deg);\n  position: absolute;\n  left: -8px;\n  top: 26px;\n  background-color: inherit;\n  z-index: -1;\n}\n.setting-info-staff .limit-box > div {\n  padding: 0 10px;\n  background-color: #FFFFFF;\n}\n.setting-info-staff .limit-box > div .checkbox {\n  width: 120px;\n  float: left;\n  margin-right: 20px;\n}\n.setting-info-staff .limit-box > div > .number-input {\n  border: 1px solid #e4e4e4;\n  width: 94px;\n  height: 20px;\n}\n.setting-info-staff .top-bar {\n  height: 50px;\n  line-height: 50px;\n  background-color: #f8f9fd;\n  text-align: right;\n}\n.setting-info-staff .top-bar > .top-box1 {\n  padding: 0 12px;\n}\n.setting-info-staff .top-bar > .top-box1 > a {\n  float: left;\n}\n.setting-info-staff .top-bar > .top-box1 > a > span {\n  font-size: 15px;\n}\n.setting-info-staff .top-bar > .top-box1 > a > span:hover {\n  cursor: pointer;\n}\n.setting-info-staff .top-bar > .top-box1 > a > div.choose {\n  width: 128px;\n  height: 156px;\n  background: #fff;\n  z-index: 10;\n  position: absolute;\n  border: 1px solid rgba(0, 0, 0, 0.2);\n  box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);\n  top: 50px;\n}\n.setting-info-staff .top-bar > .top-box1 > a > div.choose > div {\n  padding-left: 10px;\n}\n.setting-info-staff .top-bar > .top-box1 > a .checkbox,\n.setting-info-staff .top-bar > .top-box1 > a .searchbox {\n  float: left;\n  margin-right: 20px;\n}\n.setting-info-staff .top-bar > .top-box2 > div {\n  float: left;\n  padding: 0 14px;\n  position: relative;\n}\n.setting-info-staff .top-bar > .top-box2 > div:hover {\n  color: #4c8bf5;\n  cursor: pointer;\n}\n.setting-info-staff .top-bar > .top-box2 > div:hover > i {\n  color: #4c8bf5;\n}\n.setting-info-staff .top-bar > .top-box2 > div > span {\n  color: #558ef6;\n  font-size: 14px;\n}\n.setting-info-staff .top-bar > .top-box2 > div > div.bo-right {\n  width: 1px;\n  height: 14px;\n  background: #ccc;\n  position: absolute;\n  right: 0;\n  top: 19px;\n}\n.setting-info-staff .top-bar > .top-box2 > div > img {\n  vertical-align: middle;\n  padding-right: 10px;\n}\n.setting-info-staff .top-bar > .top-box2 > div > i {\n  color: #8ea4bb;\n  font-size: 18px;\n}\n.setting-info-staff .top-bar > .top-box2 > div > i:hover {\n  color: #4c8bf5;\n}\n.setting-info-staff .top-bar > .top-box2 > .option {\n  position: absolute;\n  width: 160px;\n  height: 218px;\n  left: 110px;\n  top: 50px;\n  overflow: visible;\n  border: 1px solid rgba(0, 0, 0, 0.2);\n  box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);\n  text-align: left;\n  z-index: 3;\n  background-color: #ffffff;\n}\n.setting-info-staff .top-bar > .top-box2 > .option:before {\n  border: 1px solid rgba(0, 0, 0, 0.2);\n  box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);\n  display: block;\n  content: '';\n  width: 12px;\n  height: 12px;\n  -webkit-transform: rotate(45deg);\n      -ms-transform: rotate(45deg);\n          transform: rotate(45deg);\n  position: absolute;\n  left: 15px;\n  top: -7px;\n  background-color: inherit;\n}\n.setting-info-staff .top-bar > .top-box2 > .option > p {\n  line-height: 14px;\n}\n.setting-info-staff .top-bar > .top-box2 > .option > div {\n  position: relative;\n  background-color: #ffffff;\n  line-height: 26px;\n  font-size: 12px;\n}\n.setting-info-staff .top-bar > .top-box2 > .option > div:hover {\n  background-color: #e9ecf2;\n}\n.setting-info-staff .top-bar > .top-box2 > .option > div > .number-input {\n  width: 100px;\n  height: 26px;\n  margin-right: 5px;\n  vertical-align: middle;\n}\n.setting-info-staff .top-bar > .top-box2 > a {\n  cursor: pointer;\n  padding: 0 12px;\n}\n.setting-info-staff .container {\n  position: absolute;\n  left: 12px;\n  right: 12px;\n  top: 57px;\n  bottom: 7px;\n}\n.setting-info-staff .container > .left-bar {\n  width: 250px;\n  border: 1px solid #e5e6ea;\n  height: 100%;\n}\n.setting-info-staff .container > .left-bar .qi {\n  color: #4385f5;\n  font-size: 16px;\n  line-height: 40px;\n}\n.setting-info-staff .container > .left-bar .qi > span {\n  background-color: #4385f5;\n  color: #ffffff;\n  padding: 2px;\n  margin: 0 6px;\n  border-radius: 1px;\n}\n.setting-info-staff .container > .row-view {\n  position: absolute;\n  left: 0px;\n  right: 0px;\n  top: 0;\n  bottom: 0;\n}\n.setting-info-staff .container > .row-view > .grid {\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  -webkit-transition: top 0.1s ease-out;\n  transition: top 0.1s ease-out;\n  width: auto;\n  height: auto;\n}\n.setting-info-staff .container > .row-view > .grid div.grid-title > div,\n.setting-info-staff .container > .row-view > .grid div.grid-input > div,\n.setting-info-staff .container > .row-view > .grid div.grid-append > div,\n.setting-info-staff .container > .row-view > .grid div.grid-title > div > div,\n.setting-info-staff .container > .row-view > .grid div.grid-input > div > div,\n.setting-info-staff .container > .row-view > .grid div.grid-append > div > div {\n  outline: none;\n}\n.setting-info-staff .container > .row-view > .grid div.grid-title > div.tr:nth-child(even) > div,\n.setting-info-staff .container > .row-view > .grid div.grid-input > div.tr:nth-child(even) > div,\n.setting-info-staff .container > .row-view > .grid div.grid-append > div.tr:nth-child(even) > div {\n  background-color: #f3f5fb;\n}\n.setting-info-staff .container > .row-view > .grid div.grid-title > div.tr:nth-child(odd):hover > div,\n.setting-info-staff .container > .row-view > .grid div.grid-input > div.tr:nth-child(odd):hover > div,\n.setting-info-staff .container > .row-view > .grid div.grid-append > div.tr:nth-child(odd):hover > div {\n  background-color: #ffffff;\n}\n</style><div class=\"top-bar\">\n    <div class=\"top-box1\" ng-if=\"shtop == 0\">\n    \t<a ng-mouseleave=\"hideChoose()\">\n    \t\t<span ng-mouseover=\"displayChoose()\">\u72b6\u6001</span>\n\t    \t<div class=\"choose\" ng-show=\"xschoose\">\n\t    \t\t<div ng-click=\"qi0(0)\"><checkbox ng-model=\"user.yxbz0\">\u5728\u804c</checkbox></div>\r\n\t        \t<div ng-click=\"qi1(1)\"><checkbox ng-model=\"user.yxbz1\">\u79bb\u804c</checkbox></div>\n\t        \t<div ng-click=\"open()\"><checkbox ng-model=\"yxbz3\">\u672a\u5f00\u901a</checkbox></div>\t\n\t    \t</div>\n    \t</a>\n    \t        \n        <!--<div ng-click=\"qi2(2)\"><checkbox ng-model=\"user.yxbz2\">\u5168\u90e8</checkbox></div>-->          \t\n        <anniu candidate ng-click=\"add()\">\u65b0\u589e</anniu>   \t\n    </div>\n    <div class=\"top-box2\" ng-if=\"shtop == 1\">\n        <div>\u5df2\u9009\u4e2d<span class=\"blue\">{{chooseNum}}</span>\u9879<div class=\"bo-right\"></div></div>\n        <div ng-click=\"displayOption()\"><i class=\"iconfont icon-icon1\"></i>&nbsp;\u5b89\u5168\u8bbe\u7f6e<div class=\"bo-right\"></div></div>\n        <div class='option' ng-show=\"xsoption\">\n            <div>\n                <checkbox ng-model=\"staff.cbjm\">\u6210\u672c\u52a0\u5bc6</checkbox>\t        \t\n            </div>\n            <div>\n                <checkbox ng-model=\"staff.dy\">\u6253\u5370</checkbox>\t        \t\n            </div>\n            <div>\n                <checkbox ng-model=\"staff.dc\">\u5bfc\u51fa</checkbox>\t        \t\n            </div>\n            <p>\u67e5\u8be2\u5929\u6570</p>\n            <!--<text-input placeholder=\"\u8bf7\u8f93\u5165\u67e5\u8be2\u5929\u6570\" ng-model=\"staff.cxts\"></text-input>-->\n            <div onmouseup='this.getElementsByTagName(\"input\")[0].focus()'><number-input ng-model='staff.cxts'></number-input>\u5929</div>\n            <p><anniu ng-click=\"confirm()\">\u786e\u5b9a</anniu> </p>\n        </div>\n        <div ng-click=\"bachDelete()\"><i class=\"iconfont icon-guanbi3\"></i>&nbsp;\u5220\u9664<div class=\"bo-right\"></div></div>\n        <div ng-click=\"openNewyg()\"><i class=\"iconfont icon-tianjiaren\"></i>&nbsp;\u5f00\u901a\u65b0\u5458\u5de5</div>\n        <a ng-click=\"showCancel()\"><i>\u2573</i></a>\n    </div>  \n</div>\n<div class=\"container\" col-view>\n    <div row-view>\n        <view-content name=\"staff\" noscroll></view-content>\n        <grid ng-model=\"staffs\" show-filter=\"true\" checked=\"checked\" ng-click=\"fn()\" >  \n            <div field='type' checkbox></div> \n            <div name=\"\u5e73\u53f0\u6743\u9650\" width=\"120px\" template=\"limit_template\"></div>                                                                          \t\n            <div field=\"bm\" name=\"\u5de5\u53f7\" ng-click=\"edit($, $data)\" ng-style=\"{color:'#7eaaf5'}\"></div>                    \n            <div field=\"gereninf\" name=\"\u4e2a\u4eba\u4fe1\u606f\" ng-style=\"{color:'#7eaaf5'}\" ng-click=\"edit($, $data)\"></div>\n            <div field=\"ssgsid\" name=\"\u90e8\u95e8\"></div>\n            <div field=\"gwid\" name=\"\u5c97\u4f4d\"></div>              \n            <div field=\"zaizhi\" name=\"\u5728\u804c\u72b6\u6001\" ></div>               \t                       \n        </grid>       \n    </div>\n</div>\n<view-content ng-if=\"xstc\" ng-view=\"/setting/info/staff_edit\" style=\"left:50%;right:0;top:107px;bottom:0;position: fixed;z-index: 999999999;\"></view-content>\n"}