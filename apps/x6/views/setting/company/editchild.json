{"controller":" [\"$scope\", \"alert\", \"cache\", function ($scope,alert,cache){\r\n\tvar sign=0;\r\n\t//\u83b7\u53d6\u8be6\u60c5\r\n\tapi(\"/x6/getXgGsDetail.do\",{\r\n        gsdm:$scope.data.gsdm,\r\n        id:$scope.data.id\r\n    }).onsuccess(function(res){\r\n        angular.extend($scope.data,res.gsxx);\r\n        $scope.company={\r\n\t\t\tid:$scope.data.id,\r\n\t\t\tname:$scope.data.name,\r\n\t\t\tprovince:$scope.data.province,\r\n\t\t\tcity: $scope.data.city,\r\n\t\t\ttown: $scope.data.town,\r\n\t\t\tdz: $scope.data.dz,\r\n\t\t\tfzrdm: \"\",\r\n\t\t\tyxbz:$scope.data.yxbz,//0\u542f\u7528 1\u4e0d\u542f\u7528\r\n\t\t\tarea:\"\",\r\n\t\t\trental:\"\"\r\n\t\t}\r\n    });\r\n\t//$scope.sign=0;//0\u542f\u7528 1\u4e0d\u542f\u7528\r\n\t$scope.fzrlist=cache.userlist;\r\n\t\r\n\t$scope.$watch('yxbz',function(){\r\n\t\tconsole.log(5588)\r\n\t})\r\n\t$scope.$ViewOptions={\r\n\t\t\"\u786e\u8ba4\":function(){\r\n\t\t\t//\u9a8c\u8bc1\u8f93\u5165\u5408\u6cd5\u6027\r\n\t\t\tvar required=[\r\n\t\t\t\t{\r\n\t\t\t\t\tname:\"name\",\r\n\t\t\t\t\tmsg:\"\u516c\u53f8\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname:\"province\",\r\n\t\t\t\t\tmsg:\"\u7701\u4efd\u4e0d\u80fd\u4e3a\u7a7a\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname:\"city\",\r\n\t\t\t\t\tmsg:\"\u57ce\u5e02\u4e0d\u80fd\u4e3a\u7a7a\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname:\"town\",\r\n\t\t\t\t\tmsg:\"\u53bf/\u533a\u4e0d\u80fd\u4e3a\u7a7a\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname:\"dz\",\r\n\t\t\t\t\tmsg:\"\u8be6\u7ec6\u5730\u5740\u4e0d\u80fd\u4e3a\u7a7a\"\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t\t\r\n\t\t\tvar temp=verify(required,$scope.company);\r\n\t\t\tif(temp){\r\n\t\t\t\tapi('/x6/saveXtgs.do',$scope.company).onsuccess(function(data){\r\n\t\t\t\t\tif(data.result==\"ok\"){\r\n\t\t\t\t\t\talert.success(\"\u7f16\u8f91\u6210\u529f\");\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\talert.warn(data.message);\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}else{\r\n\t\t\t\treturn false\t\r\n\t\t\t}\r\n\t\t},\r\n        \"\u5173\u95ed\":function(){\r\n                    \r\n        }\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t//\u83b7\u53d6\u8eab\u4efd\r\n\tapi(\"/x6/getProvinceList.do\",{})\r\n\t\t\t.onsuccess(function(data){\r\n\t\t\t\tfor(var i=0;i<data.list.length;i++){\r\n\t\t\t\t\tdata.list[i]=data.list[i].province;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$scope.provs=data.list;\r\n\t\t\t})\r\n\t//\u83b7\u53d6\u57ce\u5e02\r\n    \r\n\t$scope.getCityList=function(obj){\r\n\t\tsign++;\r\n\t\tif(sign>1){\r\n\t\t\t$scope.company.city=\"\";\r\n\t\t\t$scope.company.town=\"\";\r\n\t\t}\r\n\t\tvar param={\r\n\t\t\tprovince:obj\r\n\t\t}\r\n\t\tapi('/x6/getCityList.do',param)\r\n\t\t\t.onsuccess(function(data){\r\n\t\t\t\tfor(var i=0;i<data.list.length;i++){\r\n\t\t\t\t\tdata.list[i]=data.list[i].city;\r\n\t\t\t\t}\r\n\t\t\t\t$scope.citys=data.list;\r\n\t\t\t})\r\n\t}\r\n\t//$scope.getCityList($scope.data.province);\r\n    //$scope.company.city=$scope.data.city;\r\n\t//\u83b7\u53d6\u53bf\u533a\r\n    \r\n\t$scope.getTownList=function(obj){\r\n\t\tsign++;\r\n\t\tif(sign>2){\r\n\t\t\t$scope.company.town=\"\";\r\n\t\t}\r\n\t\tvar param={\r\n\t\t\tcity:obj\r\n\t\t}\r\n\t\tapi('/x6/getTownList.do',param)\r\n\t\t\t.onsuccess(function(data){\r\n\t\t\t\tfor(var i=0;i<data.list.length;i++){\r\n\t\t\t\t\tdata.list[i]=data.list[i].town;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t$scope.areas=data.list;\r\n\t\t\t})\r\n\t}\r\n\t//$scope.getTownList($scope.data.city);\r\n\t//$scope.company.town=$scope.data.town;\r\n\t\r\n\t//\u83b7\u53d6\u5143\u7d20\u4f4d\u7f6e\r\n\tfunction getElement(row,col){\r\n\t\tvar target=document.getElementsByClassName(\"edit-items\")[row].childNodes;\r\n\t\tvar _left=target[col].getBoundingClientRect().left;\r\n\t\tvar _top=target[col].getBoundingClientRect().top;\r\n\t\treturn {\r\n\t\t\tleft:_left,\r\n\t\t\ttop:_top\r\n\t\t}\r\n\t}\r\n\tfunction verify(required,obj){\r\n\t\tfor(var j = 0; j < required.length; j++) {\r\n\t\t\t\t//\u5f53\u68c0\u6d4b\u5230\u6709\u7a7a\u503c\u7684\u65f6\u5019\r\n\t\t\t\tvar row,col;\r\n\t\t\t\tif(!obj[required[j].name]) {\r\n\t\t\t\t\t//console.log(j)\r\n\t\t\t\t\tif(j==0){\r\n\t\t\t\t\t\trow=0;\r\n\t\t\t\t\t\tcol=3;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\trow=1;\r\n\t\t\t\t\t\tcol=2*j+1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar place=getElement(row,col)\r\n\t\t\t\t\talert.require(required[j].msg, place.top, place.left);\r\n\t\t\t\t\t//break;\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\treturn true;\r\n\t}\r\n\t\r\n}]","template":"<style>.setting-company-editchild .edit-items {\n  width: 80%;\n  margin: 15px auto;\n}\n.setting-company-editchild .edit-items > em {\n  line-height: 30px;\n  width: 60px;\n  display: inline-block;\n  vertical-align: top;\n}\n.setting-company-editchild .edit-items > .text-input {\n  height: 30px;\n  margin-left: 2%;\n  width: 77.5%;\n}\n.setting-company-editchild .edit-items > .selector {\n  width: 25%;\n  height: 30px;\n}\n.setting-company-editchild .edit-items > .selector + .text-input {\n  margin-left: 22%;\n}\n.setting-company-editchild .edit-items > em + .selector {\n  margin-left: 2%;\n}\n.setting-company-editchild .long > .selector {\n  width: 77%;\n}\n</style><div class=\"edit-items\">\r\n\t<em>\u5206\u516c\u53f8\u540d\u79f0</em>\r\n\t<text-input placeholder=\"\u8bf7\u8f93\u5165\u540d\u79f0\" ng-model=\"company.name\"></text-input>\r\n</div>\r\n<div class=\"edit-items\">\r\n\t<em>\u5730\u5740</em>\r\n\t<selector ng-model='company.province' source='provs'  ng-change=\"getCityList(company.province)\"></selector>\r\n\t<selector ng-model='company.city' source=\"citys\"  ng-change=\"getTownList(company.city)\"></selector>\r\n\t<selector ng-model='company.town' source='areas' ></selector>\r\n\t<text-input placeholder=\"\u8be6\u7ec6\u5730\u5740\" ng-model=\"company.dz\"></text-input>\r\n</div>\r\n<div class=\"edit-items long\">\r\n\t<em>\u8d1f\u8d23\u4eba</em>\r\n\t<selector ng-model='company.fzrdm' source='fzrlist' field='name' input></selector>\r\n</div>\r\n<div class=\"edit-items\">\r\n\t<em>\u542f\u7528\u5206\u516c\u53f8</em>\r\n\t<on-off yxbz=\"company.yxbz\"></on-off>\r\n</div>"}