{"controller":" [\"$scope\", \"views\", \"popup\", \"tasks\", \"api\", \"cache\", \"alert\", \"getfile\", \"mime\", function ($scope, views, popup, tasks, api, cache, alert,getfile,mime) {\n    $scope.$ViewTitle = '\u65b0\u589e\u5458\u5de5\u4fe1\u606f';\n    $scope.gsname = [];//\u516c\u53f8\n    $scope.gwname = [];//\u5c97\u4f4d\n    $scope.sex = [];//\u6027\u522b\n    $scope.allowname = [];//\u6743\u9650\n    $scope.zaizhistatus = [];//\u5728\u804c\u72b6\u6001\n    $scope.xlname = [];\n\n\t//\u53d6\u51fa\u516c\u53f8\u5217\u8868\u3001\u5c97\u4f4d\u5217\u8868\n\tvar gsList = cache.gslist;\n    var gwList = cache.gwlist;\n    $scope.gsList=[]\n    $scope.gwList = gwList;\n    for(var i=0;i<gsList.length;i++){\n    \tif(gsList[i].lx!=4){\n//  \t\tgsList[i].opened=true;\n//  \t\tconsole.log(gsList[i])\n    \t\t$scope.gsList.push(gsList[i]);\n    \t}\n    }\n    //\u4e0a\u4f20\u5934\u50cf\n//  var fileaccept = mime(\"png\").accept;\n//  $scope.updateAvatar = function () {\n//      getfile(fileaccept, function (file) {\n//          api(\"/x6/saveUserPic.do\", file, \"\u4e0a\u4f20\u5934\u50cf\").onsuccess(function (result) {\n//              alert.success(\"\u4e0a\u4f20\u5934\u50cf\u6210\u529f\uff01\");\n//              var fileProp = result.fileProp;\n//              $scope.staff.userpic = fileProp.showPath;\n//          });\n//\n//      });\n//  };\n    $scope.sex = [\"\u7537\", \"\u5973\"];\n    $scope.allowname = [\"\u4e0d\u5141\u8bb8\", \"\u5141\u8bb8\"];\n    $scope.zaizhistatus = [\"\u5728\u804c\", \"\u79bb\u804c\"];\n    $scope.xlname = [\"\u7814\u7a76\u751f\", \"\u672c\u79d1\", \"\u5927\u4e13\"];\n    \n    var user = {\n        sexname: \"\u7537\",\n        allow: \"\u5141\u8bb8\",\n        cbjm: 0,\n        dy: 0,\n        dc: 0,\n        zaizhi0: true\n    };\n    $scope.staff=user;\n\t//\u4e0a\u4f20\u5934\u50cf\n\tuser.isimg=false;\n    var fileaccept = mime(\"png\").accept;   \n    $scope.updateAvatar = function () {   \t\n        getfile(fileaccept, function (file) { \n        \tuser.isimg=true;\n            api(\"/x6/saveUserPic.do\", file, \"\u4e0a\u4f20\u5934\u50cf\").onsuccess(function (result) {\n                alert.success(\"\u4e0a\u4f20\u5934\u50cf\u6210\u529f\uff01\");\n                var fileProp = result.fileProp;\n                user.userpic = fileProp.showPath;\n                user.isimg=false;\n                //console.log($scope.user.userpic)\n            });\n        });        \n    };\n\n    /*{\n     * \u914d\u7f6e\u7f51\u7edc\u8bf7\u6c42\u7684\u53c2\u6570\n    }*/\n    var save = api.adapt($scope.staff, {\n        sex: \"\",\n        allowlogin: 0,\n        yxbz: 0,\n        iscbjm: 1,\n        isdy: 0,\n        isdc: 0,\n        _name: \"\",\n        _bm: \"\",\n        _phone: /^1[34578]\\d{9}$/,\n        $ssgsid: \"\",\n        $gwid: \"\",\n        rzrq: \"\",\n        csrq: \"\",\n        lzrq:\"\",\n        xl: \"\",\n        sfzh: /^\\d{6}(19|20)?\\d{2}(0[1-9]|1[0-2])([1-2]\\d|3[01]|0[1-9])\\d{3}[0-9a-zA-Z]/,\n        email: \"\"\n    }, \"/x6/saveUserInfo.do\", \"\u4fdd\u5b58\u7528\u6237\u4fe1\u606f\").onsuccess(function (result) {\n        alert.success(\"\u6dfb\u52a0\u6210\u529f\uff01\");\n        //\u6dfb\u52a0\u5b8c\u6210\u540e\u5173\u95ed\u7a97\u53e3\uff0c\u5e76\u5c06\u7528\u6237\u4fe1\u606f\u9001\u5230\u5217\u8868\u9875\u9762\n        $scope.$CloseView(result.userInfo);\n    }).onpost(function(a){\n        //\u7f51\u7edc\u8bf7\u6c42\u53d1\u8d77\u65f6\uff0c\u7981\u6709\u539f\u6765\u7684\u6309\u94ae\u7ec4\n        $scope.$ViewOptions={\n            \u6b63\u5728\u4fdd\u5b58:function(){\n                return false;\n            }\n        };\n    }).onend(function(){\n        //\u7f51\u7edc\u8bf7\u6c42\u7ed3\u675f\u540e\uff0c\u8fd8\u539f\u6309\u94ae\u7ec4\n        $scope.$ViewOptions=viewOptions;\n    });\n//\u9ed8\u8ba4\u7684\u6309\u94ae\u7ec4\nvar viewOptions={\n    \u4fdd\u5b58:function(){\n        save();\n        return false;\n    },\n    \u53d6\u6d88:null\n};\n//\u5c06\u6309\u94ae\u7ec4\u653e\u5728scope\u4e0a\uff0c\u4ee5\u4f7f\u5176\u663e\u793a\u5728\u7a97\u53e3\u5e95\u90e8\n$scope.$ViewOptions=viewOptions;\n}]","template":"<style>.setting-staff-add .field {\n  width: 356px;\n  line-height: 45px;\n  text-align: right;\n  font-size: 12px;\n  height: 45px;\n}\n.setting-staff-add .field .icon {\n  border-radius: 20%;\n  margin-left: 20px;\n  margin-right: 188px;\n  width: 40px;\n  height: 40px;\n  position: relative;\n  background-color: #26bf8c;\n}\n.setting-staff-add .field .icon > input {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  opacity: 0;\n  border: none;\n  outline: none;\n  display: block;\n}\n.setting-staff-add .field > * {\n  text-align: left;\n}\n.setting-staff-add .field > .radio {\n  display: inline-block;\n}\n.setting-staff-add .field > span:first-child {\n  margin-right: 5px;\n}\n.setting-staff-add .field .on-off {\n  float: left;\n  margin-top: -5px;\n}\n.setting-staff-add .container {\n  border-top: 1px dashed #e4e4e4;\n  padding: 15px 36px;\n  position: relative;\n}\n.setting-staff-add .container > .title {\n  height: 30px;\n  line-height: 30px;\n  font-size: 14px;\n  padding-left: 20px;\n}\n.setting-staff-add .container > .title > img {\n  vertical-align: middle;\n  margin-right: 10px;\n}\n</style>\r\n<div class=\"container\">\r\n    <div class=\"title\">\r\n        <img src=\"images/gw.png\" />\u5c97\u4f4d\u4fe1\u606f\r\n    </div>\r\n    <div class=\"item\">\r\n    \t<field name=\"\u5934\u50cf:\">        \t\r\n            <!--<div icon=\"user.pic\" class=\"size48\"><input type=\"file\" file-model=\"myFile\" id=\"file-btn\"/></div> -->\r\n            <div icon=\"user.userpic\" style=\"cursor:pointer;\" ng-click=\"updateAvatar()\" class='avatar'>\r\n                <span style=\"cursor:pointer;\" ng-if=\"!staff.userpic\"\r\n                      ng-bind='staff.name.slice(staff.name.length-2)'\r\n                      ></span>\r\n                <img ng-src=\"images/loading.gif\" class=\"load\" ng-if=\"staff.isimg\"/>\r\n            </div>             \r\n        </field>\r\n        <p></p>\r\n        <field name=\"\u59d3\u540d:\"><text-input ng-model=\"staff.name\"></text-input></field>\r\n        <field name=\"\u5de5\u53f7:\"><text-input ng-model=\"staff.bm\"></text-input></field> \r\n        <field name=\"\u624b\u673a:\"><text-input ng-model=\"staff.phone\" placeholder=\"\u8bf7\u8f93\u5165\u624b\u673a\u53f7\"></text-input></field>\r\n        <field name=\"\u90e8\u95e8:\">\r\n        \t<!--<selector empty-label=\"\u8bf7\u9009\u62e9\u90e8\u95e8\" ng-model='user.gs' source='gsname'></selector>-->\r\n        \t<tree-input ng-model=\"staff.ssgsid\" empty-label=\"\u8bf7\u9009\u62e9\u90e8\u95e8\" id-key=\"id\" multi-select=\"false\" source=\"gsList\" noicon unpack=\"true\"></tree-input>\r\n        </field>\r\n        <field name=\"\u5c97\u4f4d:\"><selector empty-label=\"\u8bf7\u9009\u62e9\u5c97\u4f4d\" ng-model='staff.gwid' id-key=\"id\" source='gwList' field=\"name\" ></selector></field>      \r\n        <field name=\"\u5728\u804c\u72b6\u6001:\" > \r\n            <!--<selector ng-model='user.zaizhi' source='zaizhistatus'></selector>--> \r\n            <div style=\"width:206px;display:inline-block;\">\r\n                <span ng-click=\"staff.yxbz = k\" ng-repeat=\"(k,v) in ['\u5728\u804c', '\u79bb\u804c']\">\r\n                    <radio ng-model=\"[true][staff.yxbz - k]\" disabled>{{v}}</radio>\r\n                </span>\r\n            </div>\r\n        </field>\r\n        <field name=\"\u5165\u804c\u65e5\u671f:\"><date-input ng-model=\"staff.rzrq\"></date-input></field>\r\n        <!--<field name=\"\u79bb\u804c\u65e5\u671f:\" ng-if=\"staff.yxbz\"><date-input ng-model=\"staff.lzrq\"></date-input></field>-->\r\n        <field name=\"\u5e73\u53f0\u6743\u9650:\">\r\n            <div style=\"width:206px;display:inline-block;\"><on-off ng-model=\"staff.allowlogin\"></on-off></div>\r\n        </field>     \r\n    </div>\r\n</div>\r\n<div class=\"container\">\r\n    <div class=\"title\">\r\n       \t<img src=\"images/geren.png\" />\u4e2a\u4eba\u8d44\u6599\r\n    </div>\r\n    <div class=\"item\">       \r\n        <field name=\"\u6027\u522b:\"><selector empty-label=\"\u8bf7\u9009\u62e9\u6027\u522b\" ng-model='staff.sexname' source='sex'></selector></field>\r\n        <field name=\"\u751f\u65e5:\"><date-input ng-model=\"staff.csrq\"></date-input></field>\r\n        <field name=\"\u5b66\u5386:\"><selector empty-label=\"\u8bf7\u9009\u62e9\u5b66\u5386\" ng-model='staff.xl' source='xlname'></selector></field>\r\n        <field name=\"\u8eab\u4efd\u8bc1:\"><text-input ng-model=\"staff.sfzh\" placeholder=\"\u8bf7\u8f93\u5165\u8eab\u4efd\u8bc1\u53f7\"></text-input></field>  \r\n        <field name=\"\u90ae\u7bb1:\"><text-input ng-model=\"staff.email\" placeholder=\"\u8bf7\u8f93\u5165\u90ae\u7bb1\"></text-input></field>\r\n    </div>\r\n</div>\r\n\r\n"}