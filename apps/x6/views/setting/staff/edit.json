{"controller":" [\"$scope\", \"getfile\", \"api\", \"cache\", \"alert\", \"mime\", \"$timeout\", function ($scope, getfile, api, cache, alert, mime, $timeout) {\n    //\u53d6\u51fa\u516c\u53f8\u5217\u8868\u3001\u5c97\u4f4d\u5217\u8868\n    var gsList = cache.gslist;\n    var gwList = cache.gwlist;\n    $scope.gsList = [];\n    //$scope.gsList = gsList;\n    $scope.gwList = gwList;\n    //\u52a0\u4e0a\u4e00\u4e2a\u6807\u9898\uff0c\u53ef\u4ee5\u8ba9\u7a97\u53e3\u62d6\u52a8\n    $scope.$ViewTitle = \"\u7f16\u8f91\u5458\u5de5\u4fe1\u606f\";\n    var _staff_watcher;\n    $scope.$watch(\"data\", function (data) {\n        _staff_watcher && _staff_watcher();//\u6e05\u9664staff\u7684\u76d1\u63a7\n        $scope.staff = {};\n        angular.extend($scope.staff, data);\n        save = api.adapt($scope.staff, {\n            _name: [\"\u59d3\u540d\", function () {}],\n            _bm: [\"\u5de5\u53f7\", function () {}],\n            sfzh: [\"\u8eab\u4efd\u8bc1\u53f7\", function (value) {\n                    if (value.length != 18) {\n                        return \"\u8eab\u4efd\u8bc1\u4f4d\u6570\u6709\u8bef\"\n                    }\n                }],\n            email: [\"\u90ae\u7bb1\", function () {}],\n            _phone: [\"\u624b\u673a\u53f7\", function (value) {\n                    if (value[0] != 1 || value.length != 11) {\n                        return \"\u624b\u673a\u53f7\u683c\u5f0f\u6709\u8bef\"\n                    }\n                }],\n            gwid: [\"\u5c97\u4f4d\", function () {}],\n            sex: ['\u59d3\u522b', function (value) {\n\n                }],\n            xl: [\"\u5b66\u5386\", function () {}],\n            rzrq: [\"\u5165\u804c\u65e5\u671f\", function (value) {\n\n                }],\n            //$lzrq:[\"\u79bb\u804c\u65e5\u671f\",function(){}],\n            csrq: [\"\u51fa\u751f\u65e5\u671f\", function (value) {}],\n            lzrq: [\"lzrq\", function (value) {}],\n            yxbz: [\"\u6709\u6548\u6807\u5fd7\", function (value) {\n\n                }],\n            allowlogin: [\"\u5141\u8bb8\u767b\u5f55\", function () {}],\n            userpic: [\"\u5934\u50cf\", function () {}],\n            id: [\"id\", function () {}],\n            ssgsid: [\"ssgsid\", function () {}],\n            iscbjm: [\"iscbjm\", function () {}],\n            flags: [\"flags\", function () {}]\n\n        }, \"/x6/saveUserInfo.do\").onsuccess(function () {\n            //alert.success(\"success\")\n            angular.extend(data, $scope.staff);\n        }).onpost(function (obj) {\n//            if (parseInt(obj.rzrq)) {\n//                obj.rzrq = bq(obj.rzrq);\n//            }\n//            if (parseInt(obj.csrq)) {\n//                obj.rzrq = bq(obj.csrq);\n//            }\n//            if (parseInt(obj.lzrq)) {\n//                obj.rzrq = bq(obj.lzrq);\n//            }\n        }).onprevent(function (obj) {\n            console.log(obj);\n        });\n\n        api('/x6/getUserInfo.do', {\n            gsdm: $scope.data.gsdm,\n            userId: $scope.data.id\n        }).onsuccess(function (result) {\n            angular.extend($scope.staff, result.userInfo);\n            var sign = 0;\n            _staff_watcher = $scope.$watch(\"staff\", function () {\n                sign++;\n                save.test();//\u7acb\u5373\u68c0\u67e5\u6570\u636e\u5408\u6cd5\u6027\n                clearTimeout(posting);\n                if (sign > 1) {\n                    posting = setTimeout(function () {\n                        save();\n                    }, 2000);\n                }\n            }, true);\n        });\n    });\n    for (var i = 0; i < gsList.length; i++) {\n        if (gsList[i].lx != 4) {\n//  \t\tgsList[i].opened=true;\n//  \t\tconsole.log(gsList[i])\n            $scope.gsList.push(gsList[i]);\n        }\n    }\n    //\u4e0a\u4f20\u5934\u50cf\n    var fileaccept = mime(\"png\").accept;\n    $scope.updateAvatar = function () {\n        $scope.staff.isimg = false;\n        getfile(fileaccept, function (file) {\n            $scope.staff.isimg = true;\n            api(\"/x6/saveUserPic.do\", file, \"\u4e0a\u4f20\u5934\u50cf\").onsuccess(function (result) {\n                $scope.staff.isimg = false;\n                alert.success(\"\u4e0a\u4f20\u5934\u50cf\u6210\u529f\uff01\");\n                var fileProp = result.fileProp;\n                $scope.staff.userpic = fileProp.showPath;\n            });\n\n        });\n    };\n    //\u66f4\u65b0\u7528\u6237\u4fe1\u606f\n    $scope.saveUserInfo = function () {\n        api('/x6/saveUserInfo.do', $scope.data).onsuccess(function (data) {\n            alert.success(\"\u7f16\u8f91\u6210\u529f\");\n        });\n    };\n\n\n\n    var id = -1;\n    $scope.sexs = [\n        {name: '\u7537', id: 0},\n        {name: '\u5973', id: 1}\n    ];\n    $scope.allows = [\n        {name: '\u4e0d\u5141\u8bb8', id: 0},\n        {name: '\u5141\u8bb8', id: 1}\n    ];\n    $scope.xuelis = [\"\u7814\u7a76\u751f\", \"\u672c\u79d1\", \"\u5927\u4e13\"];\n    //\u4fe1\u606f\u53d8\u5316\u65f6\u66f4\u65b0\u5230\u670d\u52a1\u5668;\n    //\u83b7\u53d6\u5458\u5de5\u4fe1\u606f\n    var posting;\n    var save;\n\n    function bq(str) {\n        if (str.indexOf(\"undefined\") != -1) {\n            return \"\"\n        } else {\n            var arr = str.split(\"-\");\n            if (arr[1].length == 1) {\n                arr[1] = \"0\" + arr[1];\n            }\n            if (arr[2].length == 1) {\n                arr[2] = \"0\" + arr[2];\n            }\n\n            return arr.join(\"-\");\n        }\n\n    }\n\n    //\u7f16\u8f91\u4fdd\u5b58\n\n}]","template":"<style>.setting-staff-edit {\n  /*    .editContainer{\n            position: absolute;        \n            right:0;\n            top:0;\n            bottom:0;\n            width:100%;\n            z-index:20;\n            border: 1px solid rgba(0,0,0,0.2);\n            box-shadow: 0 0 3px rgba(0,0,0,0.3);  \n    \n\n            >.anniu{\n                margin:40px;\n            }\n        }*/\n}\n.setting-staff-edit.view-content {\n  background: #fff;\n}\n.setting-staff-edit .jl {\n  background: #f2f4fa;\n  height: 10px;\n  border: 1px solid #e2e3e5;\n  border-left: none;\n  border-right: none;\n}\n.setting-staff-edit .close {\n  position: absolute;\n  right: 12px;\n  cursor: pointer;\n}\n.setting-staff-edit .avatar.icon {\n  width: 40px;\n  height: 40px;\n  border-radius: 4px;\n  background-color: #26bf8c;\n  color: #fff;\n  line-height: 40px;\n  text-align: center;\n}\n.setting-staff-edit .edit-top {\n  padding: 20px 30px 10px 30px;\n}\n.setting-staff-edit .edit-top > .title {\n  font-weight: 400;\n  line-height: 40px;\n  height: 40px;\n  padding-left: 20px;\n}\n.setting-staff-edit .edit-top > .title > span {\n  font-size: 22px;\n}\n.setting-staff-edit .edit-top > .edit-content {\n  padding: 0 35px 0 65px;\n  overflow: hidden;\n  box-sizing: border-box;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  height: 88px;\n}\n.setting-staff-edit .edit-top > .edit-content > .top-inf {\n  padding: 10px;\n  text-align: left;\n  min-width: 116px;\n  display: inline-block;\n  float: left;\n}\n.setting-staff-edit .edit-top > .edit-content > .top-inf > p {\n  font-size: 14px;\n  color: #475059;\n  min-width: 36px;\n  height: 14px;\n}\n.setting-staff-edit .edit-top > .edit-content > .top-inf > p:nth-child(1) {\n  font-size: 12px;\n  width: 100%;\n  margin-bottom: 5px;\n  text-transform: uppercase;\n  color: #8fa1b2;\n}\n.setting-staff-edit .edit-center {\n  padding: 20px 30px 10px 30px;\n  border-bottom: 1px dashed  #e4e4e4;\n}\n.setting-staff-edit .edit-center > .title {\n  height: 30px;\n  line-height: 30px;\n  font-size: 14px;\n  padding-left: 20px;\n}\n.setting-staff-edit .edit-center > .title > img {\n  vertical-align: middle;\n  margin-right: 15px;\n}\n.setting-staff-edit .field {\n  width: 356px;\n  line-height: 45px;\n  text-align: right;\n  font-size: 12px;\n  height: 45px;\n}\n.setting-staff-edit .field .icon {\n  border-radius: 20%;\n  margin-left: 20px;\n  margin-right: 188px;\n  width: 40px;\n  height: 40px;\n  position: relative;\n  background-color: #26bf8c;\n}\n.setting-staff-edit .field .icon > input {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  opacity: 0;\n  border: none;\n  outline: none;\n  display: block;\n}\n.setting-staff-edit .field > * {\n  text-align: left;\n}\n.setting-staff-edit .field > .radio {\n  display: inline-block;\n}\n.setting-staff-edit .field > span:first-child {\n  margin-right: 5px;\n}\n.setting-staff-edit .field .on-off {\n  float: left;\n  margin-top: -5px;\n}\n.setting-staff-edit .edit-bottom {\n  padding: 20px 30px 0 30px;\n}\n.setting-staff-edit .edit-bottom > .title {\n  height: 30px;\n  line-height: 30px;\n  font-size: 14px;\n  padding-left: 20px;\n}\n.setting-staff-edit .edit-bottom > .title > img {\n  vertical-align: middle;\n  margin-right: 15px;\n}\n.setting-staff-edit .edit-bottom > .item > .select {\n  padding: 10px;\n  margin-left: 45px;\n}\n</style><div class=\"edit-top\">\n    <div class=\"title\" >\n        <div class='avatar' icon='staff.userpic'>\n            <span ng-if=\"!staff.userpic\"\n                  ng-bind='staff.name.slice(staff.name.length - 2)'\n                  ></span>\n        </div>\n        <span ng-bind=\"staff.name\" style='vertical-align: top;line-height: 40px;margin-left: 10px;'></span>\n    </div>\n    <div class=\"edit-content\">\n        <div class=\"top-inf\">\n            <p>\u90e8\u95e8</p>\n            <p>{{staff.ssgsid|cache:'gslist'}}</p>\n        </div>\n        <div class=\"top-inf\">\n            <p>\u5c97\u4f4d</p>\n            <p>{{staff.gwid|cache:'gwlist'}}</p>\n        </div>\n        <div class=\"top-inf\">\n            <p>\u624b\u673a</p>\n            <p>{{staff.phone}}</p>\n        </div>\n        <div class=\"top-inf\">\n            <p>\u90ae\u7bb1</p>\n            <p>{{staff.email}}</p>\n        </div>\n        <div class=\"top-inf\">\n            <p>\u521b\u5efa\u4eba</p>\n            <p>{{staff.zdrdm|cache:'userlist'}}</p>\n        </div>\n    </div>   \t\n</div>\n<div class=\"jl\"></div>\n<div class=\"edit-center\">\n    <div class=\"title\">\n        <img src=\"images/gw.png\" />\u5c97\u4f4d\u4fe1\u606f\n    </div>\n    <div class=\"item\">\n        <field name=\"\u5934\u50cf:\" >\n            <div icon=\"staff.userpic\" style=\"cursor:pointer;\" class=\"avatar\" ng-click=\"updateAvatar()\">\n                <span style=\"cursor:pointer;\" ng-if=\"!staff.userpic\"\n                      ng-bind='staff.name.slice(staff.name.length - 2)'\n                      ></span>\n                <img ng-src=\"images/loading.gif\" class=\"load\" ng-if=\"staff.isimg\"/>\n            </div>\n        </field>\n        <P></P>\n        <field name=\"\u59d3\u540d:\"><text-input placeholder=\"\u8bf7\u8f93\u5165\u59d3\u540d\" ng-model=\"staff.name\"></text-input></field>\n        <field name=\"\u5de5\u53f7:\"><text-input placeholder=\"\u8bf7\u8f93\u5165\u5de5\u53f7\" ng-model=\"staff.bm\" ></text-input></field>\n        <p></p>\n        <field name=\"\u624b\u673a:\"><text-input placeholder=\"\u8bf7\u8f93\u5165\u624b\u673a\u53f7\" ng-model=\"staff.phone\" ></text-input></field>\n        <field name=\"\u90e8\u95e8:\">\n            <!--<selector ng-model=\"staff.ssgsid\" id-key=\"id\" source=\"gsList\" field=\"name\"></selector>-->\n            <tree-input ng-model=\"staff.ssgsid\" id-key=\"id\" multi-select=\"false\" source=\"gsList\" noicon unpack=\"true\" ></tree-input>\n            <!--<tree-input ng-model=\"value\" multi-select=\"false\" source=\"gsList\"></tree-input>-->\n            <!--<div class=\"department\">\n                    <text-input ng-model=\"bm\"></text-input>\n                    \n                    <div>\n                            <p>\u5206\u516c\u53f8\u4e00</p>\n                    </div>\n                    <div>asasas</div>\n                    <div>asasas</div>\n            </div>-->\n        </field>\n        <p></p>\n        <field name=\"\u5c97\u4f4d:\"><selector empty-label=\"\u8bf7\u9009\u62e9\u5c97\u4f4d\" ng-model='staff.gwid' id-key=\"id\" source='gwList' field=\"name\" noicon></selector></field>      \n        <field name=\"\u5728\u804c\u72b6\u6001:\" > \n            <!--<selector ng-model='user.zaizhi' source='zaizhistatus'></selector>--> \n            <div style=\"width:253px;display:inline-block;\">\n                <span ng-click=\"staff.yxbz = k\" ng-repeat=\"(k,v) in ['\u5728\u804c', '\u79bb\u804c']\" style=\"margin: 0 10px;\">\n                    <radio ng-model=\"[true][staff.yxbz - k]\" disabled>{{v}}</radio>\n                </span>\n            </div>\n        </field>\n        <p></p>\n        <field name=\"\u5165\u804c\u65e5\u671f:\"><date-input ng-model=\"staff.rzrq\"></date-input></field>\n        <field name=\"\u5e73\u53f0\u6743\u9650:\">\n            <div style=\"width:253px;display:inline-block;\"><on-off ng-model=\"staff.allowlogin\"></on-off></div>\n        </field> \n    </div>    \t\n</div>\n<div class=\"edit-bottom\">\n    <div class=\"title\">\n        <img src=\"images/geren.png\" ng-click=\"show()\"/>\u4e2a\u4eba\u8d44\u6599\n    </div>\n    <div class=\"item\">\n        <field name=\"\u6027\u522b:\"><selector empty-label=\"\u8bf7\u9009\u62e9\u6027\u522b\" ng-model='staff.sex' field='name' id-key='id' source=\"sexs\"></selector></field>\n        <field name=\"\u751f\u65e5:\"><date-input ng-model=\"staff.csrq\"></date-input></field>\n        <P></P>\n        <field name=\"\u5b66\u5386:\"><selector empty-label=\"\u8bf7\u9009\u62e9\u5b66\u5386\" ng-model='staff.xl' source='xuelis'></selector></field>\n        <field name=\"\u8eab\u4efd\u8bc1:\"><text-input ng-model=\"staff.sfzh\" placeholder=\"\u8bf7\u8f93\u5165\u8eab\u4efd\u8bc1\u53f7\"></text-input></field>\n        <field name=\"\u90ae\u7bb1:\"><text-input ng-model=\"staff.email\" placeholder=\"\u8bf7\u8f93\u5165\u90ae\u7bb1\" ></text-input></field>\n    </div>\n</div>\n"}